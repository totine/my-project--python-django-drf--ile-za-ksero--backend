{% extends "base.html" %}
{% load mathfilters %}

{% block title %}
    Kalkulator
{% endblock %}

{% block body %}
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                <h1>Ile za ksero?</h1>
                <p>Masz do skserowania książkę? Sprawdź ile będzie Cię to kosztować.</p>
                <p>Chcesz sprzedać niepotrzebne już kserówki? Ułatw sobie wycenę.</p>
                <h1>KALKULATOR</h1>
                <form method="post" action="/calc/calculate/">
                {% csrf_token %}
                 <div>
                        <label for="name">Nazwa
                            <input type="text" name="name" class="input-alternate" placeholder="Nazwa (opcjonalnie)" value="{{ xero_cost.name }}">
                        </label>
                    </div>
                    <div>
                        <label for="number_of_pages_or_cards">Ilość kartek lub stron
                            <input type="number" name="number_of_pages_or_cards" class="input-alternate" placeholder="Ilość stron lub kartek" value= {% if xero_cost.is_cards_in_form %} "{{ xero_cost.number_of_cards }}" {% else %}  "{{ xero_cost.number_of_pages }}" {% endif %}>
                        </label>
                    </div>
                <div>
                    <input type="radio" name="pages_or_cards" value="cards" {% if xero_cost.is_cards_in_form %}checked{% endif %}>kartki
                    <input type="radio" name="pages_or_cards" value="pages" {% if not xero_cost.is_cards_in_form %}checked{% endif %}>strony

                </div>
                    <div>
                        <label for="sides">1- czy 2-stronne
                            <input type="radio" name="sides" value="onesided" onchange="hidePagesInputs()"
                                   {% if xero_cost.is_one_sided %}checked{% endif %}> Wszystkie 1-stronne
                            <input type="radio" name="sides" value="twosided" onchange="hidePagesInputs()"
                                   {% if xero_cost.is_two_sided %}checked{% endif %}> Wszystkie 2-stronne
                            <input type="radio" name="sides" value="mixonesided"
                                   onchange="showPagesInput('twosided-in-mixonesided')"
                                   {% if xero_cost.is_mix_with_one_sided_advantage %}checked{% endif %}> Przewaga 1-stronnych
                            <input type="number" id="twosided-in-mixonesided" name="twosided-in-mixonesided"
                                   {% if not xero_cost.is_mix_with_one_sided_advantage %}hidden{% endif %}
                                   value="{{ xero_cost.two_sided_pages_in_mix }}">
                            <input type="radio" name="sides" value="mixtwosided"
                                   onchange="showPagesInput('onesided-in-mixtwosided')"
                                   {% if xero_cost.is_mix_with_two_sided_advantage %}checked{% endif %}> Przewaga 2-stronnych
                            <input type="number" id="onesided-in-mixtwosided" name="onesided-in-mixtwosided"
                                   {% if not xero_cost.is_mix_with_two_sided_advantage %}hidden{% endif %}
                                    value="{{ xero_cost.one_sided_pages_in_mix }}">
                        </label>
                    </div>
                    <div>
                        <label for="cost_per_page" >Koszt 1 strony ksero
                        {% for cost in xero_cost.XERO_COSTS %}
                        <input type="radio"
                                class="{% if cost == xero_cost.cost_per_page_in_grosz %}btn btn-red{% else %}btn btn-amber{% endif %}"
                               {% if cost == xero_cost.cost_per_page_in_grosz %}checked{% endif %}
                               value="{{ cost }}" name="cost_per_page">{{ cost }} gr

                        {% endfor %}
                        </label>
                    </div>
                    <div>
                        <label for="cost_per_page" >Koszt bindu
                        {% for cost in xero_cost.BIND_COSTS %}
                        <input type="radio"
                                class="{% if cost == xero_cost.bind_cost %}btn btn-red{% else %}btn btn-amber{% endif %}"
                                {% if cost == xero_cost.bind_cost %}checked{% endif %}
                                value="{{ cost }}" name="bind_cost">{{ cost }} zł

                        {% endfor %}
                        </label>
                    </div>
                <button type="submit">Policz</button>
                </form>
             <form action="/calc/calculate-book/" method="post">
             {% csrf_token %}
                 <div>
                        <label for="name">Nazwa
                            <input type="text" name="name" class="input-alternate" placeholder="Nazwa (opcjonalnie)" value="{{ xero_cost.name }}">
                        </label>
                    </div>
                    <div>
                        <label for="number_of_pages">Ilość stron w książce
                            <input type="number" name="book_pages_arabic" class="input-alternate" placeholder="Ilość stron" value="{% if xero_cost.book_pages_arabic %}{{ xero_cost.book_pages_arabic }}{% else %}0{% endif %}">
                            <input type="number" name="book_pages_roman" class="input-alternate" placeholder="Ilość stron" value="{% if xero_cost.book_pages_roman %}{{ xero_cost.book_pages_roman }}{% else %}0{% endif %}">
                        </label>
                    </div>

                    <div>
                        <label for="cost_per_page" >Koszt 1 strony ksero
                        {% for cost in xero_cost.XERO_COSTS %}
                        <input type="radio"
                                class="{% if cost == xero_cost.cost_per_page_in_grosz %}btn btn-red{% else %}btn btn-amber{% endif %}"
                               {% if cost == xero_cost.cost_per_page_in_grosz %}checked{% endif %}
                               value="{{ cost }}" name="cost_per_page">{{ cost }} gr

                        {% endfor %}
                        </label>
                    </div>
                    <div>
                        <label for="cost_per_page" >Koszt bindu
                        {% for cost in xero_cost.BIND_COSTS %}
                        <input type="radio"
                                class="{% if cost == xero_cost.bind_cost %}btn btn-red{% else %}btn btn-amber{% endif %}"
                                {% if cost == xero_cost.bind_cost %}checked{% endif %}
                                value="{{ cost }}" name="bind_cost">{{ cost }} zł

                        {% endfor %}
                        </label>
                    </div>
                <button type="submit">Policz</button>
                </form>

            <div>
                <h3>Ilość stron ksera: {{ xero_cost.number_of_pages }}</h3>
                <h2>Kwota bez bindu: {{ xero_cost.calc_xero_cost_without_bind }} zł</h2>
                <h2>Kwota z bindem: {{ xero_cost.calc_xero_cost_with_bind }} zł</h2>
                <h3>Cena bindu: {{ xero_cost.bind_cost }} (sugerowany koszt: {{ suggested_bind_price }} zł)</h3>
                <a class="btn btn-red" href="/calc/add">Dodaj</a>
            </div>
            <div>
            <h2>Lista kser</h2>
            <a href="/calc/reset">Zresetuj</a>
            <table class="table">
            <tr>
                <th>Nazwa</th>
                <th>Ilość stron</th>
                <th>Cena za stronę ksera</th>
                <th>Koszt bindu</th>
                <th>Cały koszt bez bindu</th>
                <th>Cały koszt z bindem</th>
            </tr>
                {% for xero in xero_list.get_all_xero_calcs %}
                    <tr>
                    <td>{{ xero.name }}</td>
                    <td>{{ xero.number_of_pages }}</td>
                    <td>{{ xero.cost_per_page_in_grosz }} gr</td>
                    <td>{{ xero.bind_cost }} zł</td>
                    <td>{{ xero.calc_xero_cost_without_bind }} zł</td>
                        <td><b>{{ xero.calc_xero_cost_with_bind }} zł</b></td>
                    <td>
                        <a href="/calc/costs/{{xero.id }}/delete"><i class="material-icon"></i>delete</a>
                    </td>
                    </tr>
                {% endfor %}
                    <tr>
                        <td>Razem:</td>
                        <td>{{ xero_list.get_all_xero_pages }}</td>
                        <td><br></td>
                        <td>{{ xero_list.get_all_bind_cost }} zł</td>
                        <td>{{ xero_list.get_all_cost_without_bind }} zł</td>
                        <td><b>{{ xero_list.get_all_cost_with_bind }} zł</b></td>
                    </tr>

            </table>

            </div>
            </div>
        </div>
    </div>
    <script>
    function showPagesInput(id) {
        input = document.getElementById(id);
        input.removeAttribute('hidden');
        id == "onesided-in-mixtwosided" ? document.getElementById('twosided-in-mixonesided').setAttribute("hidden", true) :
            document.getElementById('onesided-in-mixtwosided').setAttribute("hidden", true);
    }

    function hidePagesInputs() {
        var oneSided = document.getElementById('twosided-in-mixonesided');
            oneSided.setAttribute("hidden", true);
            oneSided.value = 0;
        var twoSided = document.getElementById('onesided-in-mixtwosided')
            twoSided.setAttribute("hidden", true);
            twoSided.value = 0;
    }
    </script>
{% endblock %}
